{
  "$schema": "http://json-schema.org/draft-00/schema#",
  "$id": "hdmf.schema.json",
  "title": "HDMF schema",
  "description": "A schema for validating HDMF YAML files",
  "type": "object",
  "properties": {
    "groups": {"$ref": "#/definitions/groups"},
    "attributes": {"$ref": "#attributes"},
    "datasets": {"$ref": "#datasets"},
    "links": {"$ref": "#links"}
  },
  "definitions": {
    "quantity": {
      "$id": "#quantity",
      "description": "Quantity marker",
      "anyOf": [
        {
          "type": "integer",
          "minimum": 1
        },
        {
          "type": "string",
          "enum": [
            "*",
            "?",
            "+",
            "zero_or_many",
            "one_or_many",
            "zero_or_one"
          ]
        }
      ]
    },
    "dtype": {
      "$id": "#dtype",
      "description": "Required string describing the data type of the attribute",
      "anyOf": [
        {
          "type": "string",
          "enum": [
            "float",
            "float32",
            "double",
            "float64",
            "long",
            "int64",
            "int",
            "int32",
            "int16",
            "int8",
            "uint32",
            "uint16",
            "uint8",
            "numeric",
            "text",
            "utf",
            "utf8",
            "unt-8",
            "ascii",
            "bool",
            "isodatetime"
          ]
        },
        {
          "$ref": "#ref_dtype"
        }
      ]
    },
    "dims": {
      "$id": "#dims",
      "description": "Optional list describing the names of the dimensions of the data array stored by the attribute (default=None)",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "shape": {
      "$id": "#shape",
      "description": "Optional list describing the allowed shape(s) of the data array stored by the attribute (default=None)",
      "type": "array",
      "items": {
        "type": "integer",
        "minimum": 1
      }
    },
    "ref_dtype": {
      "$id": "#ref_dtype",
      "requires": ["target_type", "reftype"],
      "properties": {
        "target_type": {
          "description": "Describes the neurodata_type of the target that the reference points to",
          "type": "string"
        },
        "reftype": {
          "description": "describes the kind of reference",
          "type": "string",
          "enum": ["ref", "reference", "object", "region"]
        }
      }
    },
    "object": {
      "$id": "#object",
      "required": ["name", "doc"],
      "properties": {
        "name": {"type": "string"},
        "doc": {"type": "string"}
      }
    },
    "data": {
      "$id": "#data",
      "required": ["dtype"],
      "properties": {
        "dtype": {"$ref": "#dtype"},
        "dims": {"$ref": "#dims"},
        "shape": {"$ref": "#shape"}
      }
    },
    "inheritable": {
      "$id": "#inheritable",
      "properties": {
        "neurodata_type_def": {"type": "string"},
        "neurodata_type_inc": {"type": "string"},
        "default_name": {"type": "string"},
        "quantity": {"$ref":  "#quantity"},
        "linkable": {"type": "boolean"},
        "attributes": {"$ref": "#attibutes"}
      }
    },
    "groups": {
      "$id": "#groups",
      "description": "list of groups",
      "type": "array",
      "items": {
        "group": {
          "type": "object",
          "allOf": [
            {"$ref": "#object"},
            {"$ref": "#inheritable"}
          ],
          "properties": {
            "datasets": {"$ref": "#datasets"},
            "links": {"$ref": "#links"},
            "groups": {"$ref": "#groups"}
          }
        }
      }
    }
  },
  "attributes": {
    "$id": "attributes",
    "type": "array",
    "items": {
      "attribute": {
        "type": "object",
        "allOf": [
          {"$ref": "#object"},
          {"$ref": "#data"},
          {
            "properties": {
              "required": {"type": "boolean"},
              "value": {"description": "Optional constant, fixed value for the attribute."},
              "default_value": {
                "description": "Optional default value for variable-valued attributes. Only one of value or default_value should be set."
              }
            }
          }
        ]

      }
    }
  },
  "links": {
    "$id": "#links",
    "type": "array",
    "items": {
      "link": {
        "type": "object",
        "allOf": [
          {"$ref": "#object"},
          {
            "required": ["target_type"],
            "properties": {"target_type": {"type": "string"}}
          }
        ]
      }
    }
  },
  "datasets": {
    "$id": "#datasets",
    "type": "array",
    "items": {
      "dataset": {
        "type": "object",
        "allOf": [
          {"$ref": "#object"},
          {"$ref": "#data"},
          {"$ref": "#inheritable"}
        ]
      }
    }
  }
}
